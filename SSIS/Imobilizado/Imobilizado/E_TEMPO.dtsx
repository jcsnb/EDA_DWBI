<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="9/28/2017 12:48:09 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="LT123516"
  DTS:CreatorName="NOVABASE\NB14865"
  DTS:DTSID="{BE287EAC-4D44-41B7-8B37-46FD0A48C77B}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="13.0.2165.0"
  DTS:LocaleID="2070"
  DTS:ObjectName="E_TEMPO"
  DTS:PackageType="5"
  DTS:ProtectionLevel="2"
  DTS:VersionBuild="125"
  DTS:VersionGUID="{A18E3F52-0132-4BAB-83C8-71111E9EB962}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:Description="Data limite da geração de datas da dimensão Tempo"
      DTS:DTSID="{01D7E85C-FA08-46EC-A33A-A1B2C8951191}"
      DTS:ObjectName="data_fim"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">20261231</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:Description="Data de início a partir do qual as datas são geradas para a dimensão Tempo"
      DTS:DTSID="{91018FED-68CB-49F2-88C0-5FCAE98913D3}"
      DTS:ObjectName="data_inicio"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">20160101</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{8F380A6C-8D1C-4E4D-B56D-74B105087633}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="chave_auditoria">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{1E15616D-3CF2-493E-B7A3-BEE89D71C894}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="numero_registos_final">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{44D9180C-DD3B-4131-A19A-F02860BB8550}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="numero_registos_inicial">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E3939EBD-53A9-4FE9-BD8D-7AE777DA5086}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="origem">
      <DTS:VariableValue
        DTS:DataType="8">Script SQL</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{99A113A7-8792-4817-B017-0F1A285C9F05}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="tabela">
      <DTS:VariableValue
        DTS:DataType="8">e_tempo</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">1,7,OnError</DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">0</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">0</DTS:Property>
    </DTS:Property>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Criação dos registos da Dimensão Tempo"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{50EB1454-3A2B-4440-95A1-C726FCAB9B41}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Criação dos registos da Dimensão Tempo">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Criação dos registos da Dimensão Tempo\Geração das datas para o período selecionado"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{EB3BC364-70CB-4D9D-812A-20898D47B08D}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Geração das datas para o período selecionado"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{794BA778-2C33-4A48-9EE1-3781430DD008}"
              SQLTask:SqlStatementSource="/* Colocar a linguagem pretendida */&#xA;SET LANGUAGE Portuguese&#xA;SET NOCOUNT ON&#xA;&#xA;-- Variáveis para datas de início e fim&#xA;DECLARE @data_inicio DATE&#xA;DECLARE @data_fim DATE&#xA;&#xA;-- Flag para determinar se é o último dia do mês e ano&#xA;DECLARE @ultimo_dia_mes BIT&#xA;DECLARE @ultimo_dia_ano BIT&#xA;&#xA;--Data atual no ciclo&#xA;DECLARE @data_ciclo_atual DATE &#xA;&#xA;-- Definir as datas de início e fim para popular com dados&#xA;SET @data_inicio = ?&#xA;SET @data_fim = ? &#xA;&#xA;-- Começar o ciclo&#xA;SET @data_ciclo_atual = @data_inicio&#xA;&#xA;WHILE @data_ciclo_atual &lt;= @data_fim&#xA;      BEGIN&#xA;&#xA;            -- Definir valor para ultimo dia do mês&#xA;            IF MONTH(@data_ciclo_atual) = MONTH(DATEADD(d, 1, @data_ciclo_atual))&#xA;               SET @ultimo_dia_mes = 0&#xA;            ELSE&#xA;               SET @ultimo_dia_mes = 1 &#xA;&#x9;&#x9;&#x9;   &#xA;&#x9;&#x9;&#x9;-- Definir valor para ultimo dia do ano&#xA;            IF YEAR(@data_ciclo_atual) = YEAR(DATEADD(d, 1, @data_ciclo_atual))&#xA;               SET @ultimo_dia_ano = 0&#xA;            ELSE&#xA;               SET @ultimo_dia_ano = 1      &#xA;&#xA;            -- Adiciona registo&#xA;INSERT INTO e_tempo (sk_tempo,data,data_completa,mes_ano,ano,semestre,trimestre,mes,semana,&#xA; &#x9;&#x9;       dia_ano,dia_mes,nome_mes,nome_dia,estacao_ano,fim_semana,ultimo_dia_mes,ultimo_dia_ano)&#xA;     VALUES  (&#xA;                     (YEAR(@data_ciclo_atual) * 10000 ) + ( MONTH(@data_ciclo_atual) * 100 ) + DAY(@data_ciclo_atual) -- sk_tempo&#xA;                    , @data_ciclo_atual -- data&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;, FORMAT(@data_ciclo_atual, 'D', 'pt-PT' ) -- data_completa&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;, LEFT(DATENAME(mm, @data_ciclo_atual),3) + ' ' + CAST(YEAR(@data_ciclo_atual) as varchar(4)) -- mes_ano&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;, YEAR(@data_ciclo_atual) -- ano&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;, CAST(YEAR(@data_ciclo_atual) as varchar(4)) + ' / '+ CASE WHEN MONTH(@data_ciclo_atual) &gt; 6 THEN '2º Semestre' ELSE '1º Semestre' END -- semestre &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;, CAST(YEAR(@data_ciclo_atual) as varchar(4)) + ' / '+ DATENAME(qq,@data_ciclo_atual) + 'º Trimestre' -- trimestre&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;, MONTH(@data_ciclo_atual) -- mes&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;, DATENAME(ww, @data_ciclo_atual) --semana&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;, DATENAME(dy, @data_ciclo_atual) --dia_ano&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;, DATENAME(dd, @data_ciclo_atual) --dia_mes   &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;, DATENAME(mm, @data_ciclo_atual) --nome_mes              &#xA;                    , DATENAME(dw, @data_ciclo_atual) --nome_dia&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;,CASE&#xA;                         WHEN MONTH(@data_ciclo_atual) &lt; 3 THEN 'inverno'&#xA;                         WHEN MONTH(@data_ciclo_atual) = 3 THEN&#xA;                           CASE WHEN DAY(@data_ciclo_atual) &lt;= 19 THEN 'inverno' ELSE 'primavera' END&#xA;                         WHEN MONTH(@data_ciclo_atual) &lt; 6 THEN 'primavera'&#xA;                         WHEN MONTH(@data_ciclo_atual) = 6 THEN&#xA;                           CASE WHEN DAY(@data_ciclo_atual) &lt;= 20 THEN 'primavera' ELSE 'verão' END&#xA;                         WHEN MONTH(@data_ciclo_atual) &lt; 9 THEN 'verão'&#xA;                         WHEN MONTH(@data_ciclo_atual) = 9 THEN&#xA;                           CASE WHEN DAY(@data_ciclo_atual) &lt;= 22 THEN 'verão' ELSE 'outono' END&#xA;                         WHEN MONTH(@data_ciclo_atual) &lt; 12 THEN 'outono'&#xA;                         WHEN MONTH(@data_ciclo_atual) = 12 THEN&#xA;                           CASE WHEN DAY(@data_ciclo_atual) &lt;= 20 THEN 'outono' ELSE 'inverno' END&#xA;                       END -- estacao_ano&#xA;                    , CASE &#xA;                        WHEN DATENAME(dw, @data_ciclo_atual) = 'sábado' or &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; DATENAME(dw, @data_ciclo_atual) = 'domingo' THEN 1&#xA;                        ELSE 0&#xA;                      END --fim_semana&#xA;                    , @ultimo_dia_mes --ultimo dia do mes&#xA;                    , @ultimo_dia_ano --ultimo dia do ano&#xA;                    )&#xA;&#xA;            -- Incrementa o contador&#xA;            SET @data_ciclo_atual = DATEADD(d, 1, @data_ciclo_atual)&#xA;      END&#xA;&#xA;SET NOCOUNT ON" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="$Package::data_inicio"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="$Package::data_fim"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Criação dos registos da Dimensão Tempo\Limpeza da tabela de extração"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="TRUNCATE TABLE e_tempo"
          DTS:DTSID="{802DC836-22CA-463B-B72E-DC27B652191A}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Limpeza da tabela de extração"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{794BA778-2C33-4A48-9EE1-3781430DD008}"
              SQLTask:SqlStatementSource="DECLARE @sql varchar(100)&#xA;SET @sql = 'TRUNCATE TABLE ' + ?&#xA;EXEC (@sql)&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::tabela"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Criação dos registos da Dimensão Tempo.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{07842984-1422-4A56-88C0-BE4B73462711}"
          DTS:From="Package\Criação dos registos da Dimensão Tempo\Limpeza da tabela de extração"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\Criação dos registos da Dimensão Tempo\Geração das datas para o período selecionado" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Fim do processo de auditoria"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{EA407EEF-5E1B-4592-B504-8AF0AB43136F}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Fim do processo de auditoria">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Fim do processo de auditoria\Atualiza registo de auditoria"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{7FCA397E-7AD1-46F1-8710-6D591F433CD4}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Atualiza registo de auditoria"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{3C7B1FFB-933F-449D-B7BE-023614EA667A}"
              SQLTask:SqlStatementSource=" UPDATE dim_auditoria&#xA;    SET numero_registos_final = ?,&#xA;&#x9;    numero_registos_inseridos = ?,&#xA;&#x9;&#x9;data_fim = CURRENT_TIMESTAMP,&#xA;&#x9;&#x9;duracao = CAST(DATEADD(SECOND,DATEDIFF(second,data_inicio, CURRENT_TIMESTAMP),'2017-01-01 00:00:00.000') AS TIME),&#xA;&#x9;&#x9;sucesso = 1&#xA;  WHERE sk_auditoria = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::numero_registos_final"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::numero_registos_final"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::chave_auditoria"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Fim do processo de auditoria\Conta Nº Registos Final"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{FFF5ACA8-C792-44CB-A41E-1BB743BCA1DA}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Conta Nº Registos Final"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{794BA778-2C33-4A48-9EE1-3781430DD008}"
              SQLTask:SqlStatementSource="SELECT SUM (row_count) AS numero_registos_final&#xA;  FROM sys.dm_db_partition_stats&#xA; WHERE object_id=OBJECT_ID(?)   &#xA;   AND (index_id=0 OR index_id=1)"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="numero_registos_final"
                SQLTask:DtsVariableName="User::numero_registos_final" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::tabela"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Fim do processo de auditoria.PrecedenceConstraints[Constraint 4]"
          DTS:CreationName=""
          DTS:DTSID="{FBC32016-862D-4AC5-AA47-B864AFA82F06}"
          DTS:From="Package\Fim do processo de auditoria\Conta Nº Registos Final"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 4"
          DTS:To="Package\Fim do processo de auditoria\Atualiza registo de auditoria" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Início do processo de auditoria"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{D50789E0-024F-4637-88FD-ED15C693C12A}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Início do processo de auditoria">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Início do processo de auditoria\Atualiza Nº Registos Inicial"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{CA612045-6411-4279-A170-1CBC6844C6B6}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Atualiza Nº Registos Inicial"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{3C7B1FFB-933F-449D-B7BE-023614EA667A}"
              SQLTask:SqlStatementSource=" UPDATE dim_auditoria&#xA;    SET numero_registos_inicial = ?&#xA;  WHERE sk_auditoria = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::numero_registos_inicial"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::chave_auditoria"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Início do processo de auditoria\Conta Nº Registos Inicial"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{188500E1-7B26-425A-A963-4D61DEDC86BE}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Conta Nº Registos Inicial"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{794BA778-2C33-4A48-9EE1-3781430DD008}"
              SQLTask:SqlStatementSource="SELECT SUM (row_count) AS numero_registos_inicial&#xA;  FROM sys.dm_db_partition_stats&#xA; WHERE object_id=OBJECT_ID(?)   &#xA;   AND (index_id=0 OR index_id=1)"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="numero_registos_inicial"
                SQLTask:DtsVariableName="User::numero_registos_inicial" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::tabela"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Início do processo de auditoria\Cria registo de auditoria"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{38832305-02D9-4666-A4DE-ABEE1677E05C}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Cria registo de auditoria"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{3C7B1FFB-933F-449D-B7BE-023614EA667A}"
              SQLTask:SqlStatementSource="INSERT INTO dim_auditoria (processo,origem,tabela,data_inicio,codigo_execucao,utilizador)&#xA;     VALUES (?,?,?,current_timestamp,?,?)&#xA;&#xA;SELECT sk_auditoria&#xA;  FROM dim_auditoria&#xA; WHERE codigo_execucao = ?"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="sk_auditoria"
                SQLTask:DtsVariableName="User::chave_auditoria" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="System::PackageName"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::origem"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::tabela"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="3"
                SQLTask:DtsVariableName="System::ExecutionInstanceGUID"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="72"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="4"
                SQLTask:DtsVariableName="System::UserName"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="5"
                SQLTask:DtsVariableName="System::ExecutionInstanceGUID"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="72"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Início do processo de auditoria.PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{8BE3C9CB-1608-4E05-83BB-747A55368B54}"
          DTS:From="Package\Início do processo de auditoria\Cria registo de auditoria"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\Início do processo de auditoria\Conta Nº Registos Inicial" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Início do processo de auditoria.PrecedenceConstraints[Constraint 2]"
          DTS:CreationName=""
          DTS:DTSID="{988D79D1-C14A-4505-A860-D6E5C927D57E}"
          DTS:From="Package\Início do processo de auditoria\Conta Nº Registos Inicial"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 2"
          DTS:To="Package\Início do processo de auditoria\Atualiza Nº Registos Inicial" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{0240CF5B-8001-4B4E-8712-FC7EF672FDAF}"
      DTS:From="Package\Início do processo de auditoria"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Criação dos registos da Dimensão Tempo" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{43987E4F-B8B3-488A-ABC0-60DB1A398583}"
      DTS:From="Package\Criação dos registos da Dimensão Tempo"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Fim do processo de auditoria" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DelayValidation="True"
      DTS:DTSID="{75F9481B-09BD-4AB7-8F30-D7904BC86FBB}"
      DTS:EventID="509082520"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{67473633-78D2-4C6C-89AC-C3B1187EB769}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\Envia Email"
          DTS:CreationName="Microsoft.SendMailTask"
          DTS:DelayValidation="True"
          DTS:Description="Send Mail Task"
          DTS:DTSID="{F8460262-D8C4-49BE-84DF-35A9CC2A83C2}"
          DTS:ExecutableType="Microsoft.SendMailTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Envia Email"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[$Project::remetente_email]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="MessageSource">"Ocorreu um erro no componente " + @[System::SourceName] + ", do processo " + @[System::PackageName] + ": " + "\n\r" +@[System::ErrorDescription]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Subject">@[$Project::assunto_email_erros]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">@[$Project::destinatario_email_erros]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{4BDEEFBB-B2CB-478F-B881-07EAF97F22F6}"
              SendMailTask:From="dwbi@eda.pt"
              SendMailTask:To="pedro.soares@novabase.pt"
              SendMailTask:Subject="Erro em processo de integração de dados"
              SendMailTask:MessageSource="Ocorreu um erro no componente , do processo E_TEMPO: &#xA;&#xA;" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\Insere registo de erro"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{4C462F22-5ABD-4530-B7E1-38DB6AF035BC}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Insere registo de erro"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{794BA778-2C33-4A48-9EE1-3781430DD008}"
              SQLTask:SqlStatementSource="INSERT INTO log_erros (processo, componente, mensagem,codigo_execucao,data)&#xA;  VALUES (?,?,?,?,current_timestamp)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="System::PackageName"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="System::SourceName"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="System::ErrorDescription"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="3"
                SQLTask:DtsVariableName="System::ExecutionInstanceGUID"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="72"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{5B4E8B88-5238-4596-B5C9-6F596A040AD9}"
          DTS:From="Package.EventHandlers[OnError]\Insere registo de erro"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package.EventHandlers[OnError]\Envia Email" />
      </DTS:PrecedenceConstraints>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="296,42"
          Id="Package\Criação dos registos da Dimensão Tempo\Geração das datas para o período selecionado"
          TopLeft="5.5,86" />
        <NodeLayout
          Size="223,42"
          Id="Package\Criação dos registos da Dimensão Tempo\Limpeza da tabela de extração"
          TopLeft="43.5,9" />
        <EdgeLayout
          Id="Package\Criação dos registos da Dimensão Tempo.PrecedenceConstraints[Constraint]"
          TopLeft="154.25,51">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,35"
              Start="0,0"
              End="0,27.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,27.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="306,258"
          Size="306,301"
          Id="Package\Criação dos registos da Dimensão Tempo"
          TopLeft="537,50" />
        <NodeLayout
          Size="210,42"
          Id="Package\Fim do processo de auditoria\Atualiza registo de auditoria"
          TopLeft="5.5,83" />
        <NodeLayout
          Size="190,42"
          Id="Package\Fim do processo de auditoria\Conta Nº Registos Final"
          TopLeft="14.5,5" />
        <EdgeLayout
          Id="Package\Fim do processo de auditoria.PrecedenceConstraints[Constraint 4]"
          TopLeft="110,47">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,36"
              Start="0,0"
              End="0,28.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,28.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="254,142"
          Size="254,185"
          Id="Package\Fim do processo de auditoria"
          TopLeft="919,65" />
        <NodeLayout
          Size="205,42"
          Id="Package\Início do processo de auditoria\Atualiza Nº Registos Inicial"
          TopLeft="3,160" />
        <NodeLayout
          Size="196,42"
          Id="Package\Início do processo de auditoria\Conta Nº Registos Inicial"
          TopLeft="6,84" />
        <NodeLayout
          Size="192,42"
          Id="Package\Início do processo de auditoria\Cria registo de auditoria"
          TopLeft="10,6" />
        <EdgeLayout
          Id="Package\Início do processo de auditoria.PrecedenceConstraints[Constraint 1]"
          TopLeft="105,48">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,36"
              Start="0,0"
              End="0,28.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,28.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Início do processo de auditoria.PrecedenceConstraints[Constraint 2]"
          TopLeft="104.75,126">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34"
              Start="0,0"
              End="0,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="250,220"
          Size="250,263"
          Id="Package\Início do processo de auditoria"
          TopLeft="196,27" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="446,158.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="91,42"
              Start="0,0"
              End="83.5,42">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="41.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="41.5,0"
                    Point2="45.5,0"
                    Point3="45.5,4" />
                  <mssgle:LineSegment
                    End="45.5,38" />
                  <mssgle:CubicBezierSegment
                    Point1="45.5,38"
                    Point2="45.5,42"
                    Point3="49.5,42" />
                  <mssgle:LineSegment
                    End="83.5,42" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="843,200.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="76,-43"
              Start="0,0"
              End="68.5,-43">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="34,0" />
                  <mssgle:CubicBezierSegment
                    Point1="34,0"
                    Point2="38,0"
                    Point3="38,-4" />
                  <mssgle:LineSegment
                    End="38,-39" />
                  <mssgle:CubicBezierSegment
                    Point1="38,-39"
                    Point2="38,-43"
                    Point3="42,-43" />
                  <mssgle:LineSegment
                    End="68.5,-43" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="133,42"
          Id="Package.EventHandlers[OnError]\Envia Email"
          TopLeft="29.5,107.5" />
        <NodeLayout
          Size="181,42"
          Id="Package.EventHandlers[OnError]\Insere registo de erro"
          TopLeft="5.50000000000001,5.5" />
        <EdgeLayout
          Id="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint]"
          TopLeft="96,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>